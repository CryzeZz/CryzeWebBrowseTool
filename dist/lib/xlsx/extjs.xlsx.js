!function(e){var s,n;function o(e,t){var r=[],n=e.getColumnModel().config,a=[];for(i=0;i<n.length;i++)""==(l=n[i]).header||l.hidden||"checker"==l.id||a.push(l.header);r.push(a);for(var o=t.data.items,d=0;d<o.length;d++){var l,u,p=o[d],a=[];for(i=0;i<n.length;i++)""==(l=n[i]).header||l.hidden||"checker"==l.id||(u=p.data[l.dataIndex]||"",l.renderer&&(u=s(l.renderer(u,"",p))),a.push(u.replace(/&#160;/gi,"")));r.push(a)}return r}function d(e,t,r){return n(e,t,r)}e.Ext&&e.Ext.grid&&(s=function(e){return e.replace(/(<[^>]+>)|(&nbsp;)/gi,"")},n=function(e,t,r){for(var n=[],a=1;a<t.length;a++){for(var i={},o=t[a],d=0;d<o.length;d++)i[t[0][d]]=o[d];n.push(i)}var l=XLSX.utils.book_new(),u=XLSX.utils.json_to_sheet(n);XLSX.utils.book_append_sheet(l,u,"sheet1"),XLSX.writeFile(l,r)},e.Ext.grid.GridPanel)&&(Ext.grid.GridPanel.prototype.exportXLSX=function(e){var r,t,n,a,i;r=this,i=(e=e).filename+".xlsx",e.currentPage?(t=o(r,r.getStore()),setTimeout(function(){d("export",t,i)},0)):e.allPage&&(e=r.getStore(),a=new Ext.data.HttpProxy(new Ext.data.Connection({url:e.proxy.url})),n=new Ext.data.Store({proxy:a,reader:e.reader}),(a=Ext.apply({},e.lastOptions.params)).start=0,a.limit=9999,n.load({params:a,callback:function(e){var t=o(r,n);setTimeout(function(){d("export",t,i)},0)}}))})}(window);