function my_chrome_ext_dateFormat(e){var t,r={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(t in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),r)new RegExp("("+t+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?r[t]:("00"+r[t]).substr((""+r[t]).length)));return e}var my_chrome_ext_dgexport_count=0;function my_chrome_ext_tableexport(){"html"==$(this).data("dg")&&$(this).parent().find(">table").each(function(e){var t="table-"+($(this).attr("id")||++my_chrome_ext_dgexport_count),r=(t+="-"+my_chrome_ext_dateFormat.call(new Date,"yyyyMMdd-hhmmss-S"),console.log(t),XLSX.utils.book_new()),o=XLSX.utils.table_to_sheet(this);XLSX.utils.book_append_sheet(r,o,"sheet1"),XLSX.writeFile(r,t+".xlsx")})}function my_chrome_ext_tableexport_addBtn(){var e=$("table:visible");console.log(e),e.each(function(e){var t=$(this).parent();($(this).attr("id")||0==t.closest("table").length)&&t.is(":visible")&&0==t.find(">.my-chrome-ext.export").length&&(t.css("position")&&"static"!=t.css("position")||t.css("position","relative"),t.append('<a class="my-chrome-ext btn btn-primary export" data-dg="html" href="javascript:void(0);" onclick="my_chrome_ext_tableexport.call(this)">导出</a>'))})}function my_chrome_ext_LoadJS(e,t,r,o){var _=document.createElement("script");_.type="text/javascript","string"==typeof r?_.innerHTML=r:(_.src=e,_.charset=t),"string"==typeof o&&(_.id=o),document.getElementsByTagName("head")[0].appendChild(_)}var my_chrome_ext_CheckJquery_interval,my_chrome_ext_CheckJquery=10;"undefined"!=typeof jQuery?my_chrome_ext_tableexport_addBtn():(console.log("没有jquery"),window.my_chrome_ext_jquery_url&&(console.log("动态加载jquery",my_chrome_ext_jquery_url),my_chrome_ext_LoadJS(my_chrome_ext_jquery_url,"utf-8")),my_chrome_ext_CheckJquery_interval=window.setInterval(function(){"undefined"!=typeof jQuery?(my_chrome_ext_tableexport_addBtn(),window.clearInterval(my_chrome_ext_CheckJquery_interval)):--my_chrome_ext_CheckJquery<0&&(console.log("插入jquery失败"),window.clearInterval(my_chrome_ext_CheckJquery_interval))},500));