function my_chrome_ext_dateFormat(t){var e,a={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(e in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),a)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?a[e]:("00"+a[e]).substr((""+a[e]).length)));return t}var my_chrome_ext_dgexport_count=0;function my_chrome_ext_dgexport(){var t,e,a=$(this).data("dg");"datagrid"==a?(""==(e=(t=$(this).closest(".datagrid-wrap").find(".datagrid-view>table")).closest(".datagrid").find(".panel-header>.panel-title").text().trim())&&(e="datagrid-"+(t.attr("id")||++my_chrome_ext_dgexport_count)),e+="-"+my_chrome_ext_dateFormat.call(new Date,"yyyyMMdd-hhmmss-S"),console.log(t.datagrid("options")),t.datagrid("exportXLSX",{allPage:!0,filename:e})):"bootstarpTable"==a?(t=$(this).closest(".fixed-table-container").find(".fixed-table-body>.table"),""==(e="")&&(e="bootstrapTable-"+(t.attr("id")||++my_chrome_ext_dgexport_count)),e+="-"+my_chrome_ext_dateFormat.call(new Date,"yyyyMMdd-hhmmss-S"),t.bootstrapTable("exportXLSX",{allPage:!0,filename:e})):"gridPanel"==a&&(""==(e=(t=$(this).closest(".x-grid-panel")).find(">.x-panel-header>.x-panel-header-text").text())&&(e="gridPanel-"+(t.attr("id")||++my_chrome_ext_dgexport_count)),e+="-"+my_chrome_ext_dateFormat.call(new Date,"yyyyMMdd-hhmmss-S"),a=Ext.getCmp(t.attr("id")))&&a.exportXLSX({allPage:!0,filename:e})}function my_chrome_ext_dgexport_addBtn(){$(".datagrid-view>table").each(function(t){var e=$(this).closest(".datagrid-wrap");e.is(":visible")&&0==e.find(".my-chrome-ext.export").length&&e.append('<a class="my-chrome-ext btn btn-primary export" data-dg="datagrid" href="javascript:void(0);" onclick="my_chrome_ext_dgexport.call(this)">导出</a>')}),$(".bootstrap-table>.fixed-table-container>.fixed-table-body>.table").each(function(t){var e=$(this).closest(".fixed-table-container");e.is(":visible")&&0==e.find(".my-chrome-ext.export").length&&e.append('<a class="my-chrome-ext btn btn-primary export" data-dg="bootstarpTable" href="javascript:void(0);" onclick="my_chrome_ext_dgexport.call(this)">导出</a>')}),$(".x-grid-panel").each(function(t){var e=$(this);e.is(":visible")&&0==e.find(".my-chrome-ext.export").length&&e.append('<a class="my-chrome-ext btn btn-primary export" data-dg="gridPanel" href="javascript:void(0);" onclick="my_chrome_ext_dgexport.call(this)">导出</a>')})}!function(){function t(t,e){var a=document.createElement("script");a.type="text/javascript",a.src=t,a.charset=e,document.getElementsByTagName("head")[0].appendChild(a)}t("https://cdn.bootcss.com/blob-polyfill/3.0.20180112/Blob.min.js","utf-8"),t("https://cdn.bootcss.com/FileSaver.js/2014-11-29/FileSaver.min.js","utf-8"),t("https://cdn.bootcss.com/xlsx/0.14.1/xlsx.core.min.js","utf-8"),t("//ttykx.com/jslib/xlsx/easyui.xlsx.js","utf-8"),t("//ttykx.com/jslib/xlsx/bootstrapTable.xlsx.js","utf-8"),t("//ttykx.com/jslib/xlsx/extjs.xlsx.js","utf-8"),my_chrome_ext_dgexport_addBtn()}(jQuery);