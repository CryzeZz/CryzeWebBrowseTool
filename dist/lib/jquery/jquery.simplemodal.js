!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(i){var t=[],n=i(document),e=navigator.userAgent.toLowerCase(),a=i(window),l=[],r={ieQuirks:null,msie:/msie/.test(e)&&!/opera/.test(e),opera:/opera/.test(e)};r.ie6=r.msie&&/msie 6./.test(e)&&"object"!=typeof window.XMLHttpRequest,r.ie7=r.msie&&/msie 7.0/.test(e),r.boxModel="CSS1Compat"===document.compatMode,i.modal=function(e,o){return i.modal.impl.init(e,o)},i.modal.close=function(){i.modal.impl.close()},i.modal.focus=function(e){i.modal.impl.focus(e)},i.modal.setContainerDimensions=function(){i.modal.impl.setContainerDimensions()},i.modal.setPosition=function(){i.modal.impl.setPosition()},i.modal.update=function(e,o){i.modal.impl.update(e,o)},i.fn.modal=function(e){return i.modal.impl.init(this,e)},i.modal.defaults={appendTo:"body",focus:!0,opacity:50,overlayId:"simplemodal-overlay",overlayCss:{},containerId:"simplemodal-container",containerCss:{},dataId:"simplemodal-data",dataCss:{},minHeight:null,minWidth:null,maxHeight:null,maxWidth:null,autoResize:!1,autoPosition:!0,zIndex:1e3,close:!0,closeHTML:'<a class="modalCloseImg" title="Close"></a>',closeClass:"simplemodal-close",escClose:!0,overlayClose:!1,fixed:!0,position:null,persist:!1,modal:!0,onOpen:null,onShow:null,onClose:null},i.modal.impl={d:{},init:function(e,o){var t=this;if(t.d.data)return!1;if(r.ieQuirks=r.msie&&!r.boxModel,t.o=i.extend({},i.modal.defaults,o),t.zIndex=t.o.zIndex,t.occb=!1,"object"==typeof e)e=e instanceof i?e:i(e),t.d.placeholder=!1,0<e.parent().parent().length&&(e.before(i("<span></span>").attr("id","simplemodal-placeholder").css({display:"none"})),t.d.placeholder=!0,t.display=e.css("display"),t.o.persist||(t.d.orig=e.clone(!0)));else{if("string"!=typeof e&&"number"!=typeof e)return alert("SimpleModal Error: Unsupported data type: "+typeof e),t;e=i("<div></div>").html(e)}return t.create(e),e=null,t.open(),i.isFunction(t.o.onShow)&&t.o.onShow.apply(t,[t.d]),t},create:function(e){var o=this;o.getDimensions(),o.o.modal&&r.ie6&&(o.d.iframe=i('<iframe src="javascript:false;"></iframe>').css(i.extend(o.o.iframeCss,{display:"none",opacity:0,position:"fixed",height:l[0],width:l[1],zIndex:o.o.zIndex,top:0,left:0})).appendTo(o.o.appendTo)),o.d.overlay=i("<div></div>").attr("id",o.o.overlayId).addClass("simplemodal-overlay").css(i.extend(o.o.overlayCss,{display:"none",opacity:o.o.opacity/100,height:o.o.modal?t[0]:0,width:o.o.modal?t[1]:0,position:"fixed",left:0,top:0,zIndex:o.o.zIndex+1})).appendTo(o.o.appendTo),o.d.container=i("<div></div>").attr("id",o.o.containerId).attr("role","dialog").addClass("simplemodal-container").css(i.extend({position:o.o.fixed?"fixed":"absolute"},o.o.containerCss,{display:"none",zIndex:o.o.zIndex+2})).append(o.o.close&&o.o.closeHTML?i(o.o.closeHTML).addClass(o.o.closeClass):"").appendTo(o.o.appendTo),o.d.wrap=i("<div></div>").attr("tabIndex",-1).addClass("simplemodal-wrap").css({height:"100%",outline:0,width:"100%"}).appendTo(o.d.container),o.d.data=e.attr("id",e.attr("id")||o.o.dataId).addClass("simplemodal-data").css(i.extend(o.o.dataCss,{display:"none"})).appendTo("body"),e=null,o.setContainerDimensions(),o.d.data.appendTo(o.d.wrap),(r.ie6||r.ieQuirks)&&o.fixIE()},bindEvents:function(){var o=this;i("."+o.o.closeClass).bind("click.simplemodal",function(e){e.preventDefault(),o.close()}),o.o.modal&&o.o.close&&o.o.overlayClose&&o.d.overlay.bind("click.simplemodal",function(e){e.preventDefault(),o.close()}),n.bind("keydown.simplemodal",function(e){o.o.modal&&9===e.keyCode?o.watchTab(e):o.o.close&&o.o.escClose&&27===e.keyCode&&(e.preventDefault(),o.close())}),a.bind("resize.simplemodal orientationchange.simplemodal",function(){o.getDimensions(),o.o.autoResize?o.setContainerDimensions():o.o.autoPosition&&o.setPosition(),r.ie6||r.ieQuirks?o.fixIE():o.o.modal&&(o.d.iframe&&o.d.iframe.css({height:l[0],width:l[1]}),o.d.overlay.css({height:t[0],width:t[1]}))})},unbindEvents:function(){i("."+this.o.closeClass).unbind("click.simplemodal"),n.unbind("keydown.simplemodal"),a.unbind(".simplemodal"),this.d.overlay.unbind("click.simplemodal")},fixIE:function(){var e=this,f=e.o.position;i.each([e.d.iframe||null,e.o.modal?e.d.overlay:null,"fixed"===e.d.container.css("position")?e.d.container:null],function(e,o){var t,i,n,a,s,d,l,r,c,p,m,u,h;o&&(t="document.body.clientHeight",i="document.body.clientWidth",m="document.body.scrollHeight",n="document.body.scrollLeft",a="document.body.scrollTop",s="document.body.scrollWidth",d="document.documentElement.clientHeight",l="document.documentElement.clientWidth",r="document.documentElement.scrollLeft",c="document.documentElement.scrollTop",(p=o[0].style).position="absolute",e<2?(p.removeExpression("height"),p.removeExpression("width"),p.setExpression("height",m+" > "+t+" ? "+m+" : "+t+' + "px"'),p.setExpression("width",s+" > "+i+" ? "+s+" : "+i+' + "px"')):(f&&f.constructor===Array?(h=-1===(e=f[0]?"number"==typeof f[0]?f[0].toString():f[0].replace(/px/,""):o.css("top").replace(/px/,"")).indexOf("%")?e+" + (t = "+c+" ? "+c+" : "+a+') + "px"':parseInt(e.replace(/%/,""))+" * (("+d+" || "+t+") / 100) + (t = "+c+" ? "+c+" : "+a+') + "px"',f[1]&&(u=-1===(m="number"==typeof f[1]?f[1].toString():f[1].replace(/px/,"")).indexOf("%")?m+" + (t = "+r+" ? "+r+" : "+n+') + "px"':parseInt(m.replace(/%/,""))+" * (("+l+" || "+i+") / 100) + (t = "+r+" ? "+r+" : "+n+') + "px"')):(h="("+d+" || "+t+") / 2 - (this.offsetHeight / 2) + (t = "+c+" ? "+c+" : "+a+') + "px"',u="("+l+" || "+i+") / 2 - (this.offsetWidth / 2) + (t = "+r+" ? "+r+" : "+n+') + "px"'),p.removeExpression("top"),p.removeExpression("left"),p.setExpression("top",h),p.setExpression("left",u)))})},focus:function(e){var o=this,e=e&&-1!==i.inArray(e,["first","last"])?e:"first",t=i(":input:enabled:visible:"+e,o.d.wrap);setTimeout(function(){(0<t.length?t:o.d.wrap).focus()},10)},getDimensions:function(){var e=void 0===window.innerHeight?a.height():window.innerHeight;t=[n.height(),n.width()],l=[e,a.width()]},getVal:function(e,o){return e?"number"==typeof e?e:"auto"===e?0:0<e.indexOf("%")?parseInt(e.replace(/%/,""))/100*("h"===o?l[0]:l[1]):parseInt(e.replace(/px/,"")):null},update:function(e,o){var t=this;if(!t.d.data)return!1;t.d.origHeight=t.getVal(e,"h"),t.d.origWidth=t.getVal(o,"w"),t.d.data.hide(),e&&t.d.container.css("height",e),o&&t.d.container.css("width",o),t.setContainerDimensions(),t.d.data.show(),t.o.focus&&t.focus(),t.unbindEvents(),t.bindEvents()},setContainerDimensions:function(){var e=this,o=r.ie6||r.ie7,t=e.d.origHeight||(r.opera?e.d.container.height():e.getVal(o?e.d.container[0].currentStyle.height:e.d.container.css("height"),"h")),o=e.d.origWidth||(r.opera?e.d.container.width():e.getVal(o?e.d.container[0].currentStyle.width:e.d.container.css("width"),"w")),i=e.d.data.outerHeight(!0),n=e.d.data.outerWidth(!0),a=(e.d.origHeight=e.d.origHeight||t,e.d.origWidth=e.d.origWidth||o,e.o.maxHeight?e.getVal(e.o.maxHeight,"h"):null),s=e.o.maxWidth?e.getVal(e.o.maxWidth,"w"):null,a=a&&a<l[0]?a:l[0],s=s&&s<l[1]?s:l[1],d=e.o.minHeight?e.getVal(e.o.minHeight,"h"):"auto",t=t?e.o.autoResize&&a<t?a:t<d?d:t:i?a<i?a:e.o.minHeight&&"auto"!==d&&i<d?d:i:d,a=e.o.minWidth?e.getVal(e.o.minWidth,"w"):"auto",o=o?e.o.autoResize&&s<o?s:o<a?a:o:n?s<n?s:e.o.minWidth&&"auto"!==a&&n<a?a:n:a;e.d.container.css({height:t,width:o}),e.d.wrap.css({overflow:t<i||o<n?"auto":"visible"}),e.o.autoPosition&&e.setPosition()},setPosition:function(){var e,o=this,t=l[0]/2-o.d.container.outerHeight(!0)/2,i=l[1]/2-o.d.container.outerWidth(!0)/2,n="fixed"!==o.d.container.css("position")?a.scrollTop():0,n=o.o.position&&"[object Array]"===Object.prototype.toString.call(o.o.position)?(e=parseFloat(n)+parseFloat(o.o.position[0]||t),o.o.position[1]||i):(e=n+t,i);o.d.container.css({left:n,top:e})},watchTab:function(e){var o,t=this;0<i(e.target).parents(".simplemodal-container").length?(t.inputs=i(":input:enabled:visible:first, :input:enabled:visible:last",t.d.data[0]),(!e.shiftKey&&e.target===t.inputs[t.inputs.length-1]||e.shiftKey&&e.target===t.inputs[0]||0===t.inputs.length)&&(e.preventDefault(),o=e.shiftKey?"last":"first",t.focus(o))):(e.preventDefault(),t.focus())},open:function(){var e=this;e.d.iframe&&e.d.iframe.show(),i.isFunction(e.o.onOpen)?e.o.onOpen.apply(e,[e.d]):(e.d.overlay.show(),e.d.container.show(),e.d.data.show()),e.o.focus&&e.focus(),e.bindEvents()},close:function(){var e,o=this;if(!o.d.data)return!1;o.unbindEvents(),i.isFunction(o.o.onClose)&&!o.occb?(o.occb=!0,o.o.onClose.apply(o,[o.d])):(o.d.placeholder?(e=i("#simplemodal-placeholder"),o.o.persist?e.replaceWith(o.d.data.removeClass("simplemodal-data").css("display",o.display)):(o.d.data.hide().remove(),e.replaceWith(o.d.orig))):o.d.data.hide().remove(),o.d.container.hide().remove(),o.d.overlay.hide(),o.d.iframe&&o.d.iframe.hide().remove(),o.d.overlay.remove(),o.d={})}}});